<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Assignment 1</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
</head>
<body>
<div class="container">
  <h1 class="text-center">CSC3007-Assignment 01 by 1901857</h1>
  <p id="timestamp" class="text-center">
  </p>
  <table class="table table-hover">
    <thead>
      <tr>
        <th scope="col">Metric</th>
        <th scope="col">National</th>
        <th scope="col">Central</th>
        <th scope="col">West</th>
        <th scope="col">East</th>
        <th scope="col">North</th>
        <th scope="col">South</th>
      </tr>
    </thead>
    <tbody id="data">
    </tbody>
  </table>
</div>
</body>
<script>
  fetch("https://api.data.gov.sg/v1/environment/psi").then(
  res => {
    res.json().then(
      data => {
        console.log(data);
          var temp = "";
          var time = "";
          data.items.forEach((x) => {
            var keys = Object.keys(x.readings)
            temp += ("<tr>");
            temp += "<td>" + keys[0] +"</td>"; 
            temp += "<td>" + x.readings.o3_sub_index.national + "</td>";
            temp += "<td>" + x.readings.o3_sub_index.central + "</td>";
            temp += "<td>" + x.readings.o3_sub_index.west + "</td>";
            temp += "<td>" + x.readings.o3_sub_index.east + "</td>";
            temp += "<td>" + x.readings.o3_sub_index.north + "</td>";
            temp += "<td>" + x.readings.o3_sub_index.south + "</td>";
            temp += ("</tr>")

            temp += ("<tr>");
            temp += "<td>" + keys[1] +"</td>"; 
            temp += "<td>" + x.readings.pm10_twenty_four_hourly.national + "</td>";
            temp += "<td>" + x.readings.pm10_twenty_four_hourly.central + "</td>";
            temp += "<td>" + x.readings.pm10_twenty_four_hourly.west + "</td>";
            temp += "<td>" + x.readings.pm10_twenty_four_hourly.east + "</td>";
            temp += "<td>" + x.readings.pm10_twenty_four_hourly.north + "</td>";
            temp += "<td>" + x.readings.pm10_twenty_four_hourly.south + "</td>";
            temp += ("</tr>");

            temp += ("<tr>");
            temp += "<td>" + keys[2] +"</td>"; 
            temp += "<td>" + x.readings.pm10_sub_index.national + "</td>";
            temp += "<td>" + x.readings.pm10_sub_index.central + "</td>";
            temp += "<td>" + x.readings.pm10_sub_index.west + "</td>";
            temp += "<td>" + x.readings.pm10_sub_index.east + "</td>";
            temp += "<td>" + x.readings.pm10_sub_index.north + "</td>";
            temp += "<td>" + x.readings.pm10_sub_index.south + "</td>";
            temp += ("</tr>");

            temp += ("<tr>");
            temp += "<td>" + keys[3] +"</td>"; 
            temp += "<td>" + x.readings.co_sub_index.national + "</td>";
            temp += "<td>" + x.readings.co_sub_index.central + "</td>";
            temp += "<td>" + x.readings.co_sub_index.west + "</td>";
            temp += "<td>" + x.readings.co_sub_index.east + "</td>";
            temp += "<td>" + x.readings.co_sub_index.north + "</td>";
            temp += "<td>" + x.readings.co_sub_index.south + "</td>";
            temp += ("</tr>");

            temp += ("<tr>");
            temp += "<td>" + keys[4] +"</td>"; 
            temp += "<td>" + x.readings.pm25_twenty_four_hourly.national + "</td>";
            temp += "<td>" + x.readings.pm25_twenty_four_hourly.central + "</td>";
            temp += "<td>" + x.readings.pm25_twenty_four_hourly.west + "</td>";
            temp += "<td>" + x.readings.pm25_twenty_four_hourly.east + "</td>";
            temp += "<td>" + x.readings.pm25_twenty_four_hourly.north + "</td>";
            temp += "<td>" + x.readings.pm25_twenty_four_hourly.south + "</td>";
            temp += ("</tr>");

            temp += ("<tr>");
            temp += "<td>" + keys[5] +"</td>"; 
            temp += "<td>" + x.readings.so2_sub_index.national + "</td>";
            temp += "<td>" + x.readings.so2_sub_index.central + "</td>";
            temp += "<td>" + x.readings.so2_sub_index.west + "</td>";
            temp += "<td>" + x.readings.so2_sub_index.east + "</td>";
            temp += "<td>" + x.readings.so2_sub_index.north + "</td>";
            temp += "<td>" + x.readings.so2_sub_index.south + "</td>";
            temp += ("</tr>")

            temp += ("<tr>");
            temp += "<td>" + keys[6] +"</td>"; 
            temp += "<td>" + x.readings.co_eight_hour_max.national + "</td>";
            temp += "<td>" + x.readings.co_eight_hour_max.central + "</td>";
            temp += "<td>" + x.readings.co_eight_hour_max.west + "</td>";
            temp += "<td>" + x.readings.co_eight_hour_max.east + "</td>";
            temp += "<td>" + x.readings.co_eight_hour_max.north + "</td>";
            temp += "<td>" + x.readings.co_eight_hour_max.south + "</td>";
            temp += ("</tr>");

            temp += ("<tr>");
            temp += "<td>" + keys[7] +"</td>"; 
            temp += "<td>" + x.readings.no2_one_hour_max.national + "</td>";
            temp += "<td>" + x.readings.no2_one_hour_max.central + "</td>";
            temp += "<td>" + x.readings.no2_one_hour_max.west + "</td>";
            temp += "<td>" + x.readings.no2_one_hour_max.east + "</td>";
            temp += "<td>" + x.readings.no2_one_hour_max.north + "</td>";
            temp += "<td>" + x.readings.no2_one_hour_max.south + "</td>";
            temp += ("</tr>");

            temp += ("<tr>");
            temp += "<td>" + keys[8] +"</td>"; 
            temp += "<td>" + x.readings.so2_twenty_four_hourly.national + "</td>";
            temp += "<td>" + x.readings.so2_twenty_four_hourly.central + "</td>";
            temp += "<td>" + x.readings.so2_twenty_four_hourly.west + "</td>";
            temp += "<td>" + x.readings.so2_twenty_four_hourly.east + "</td>";
            temp += "<td>" + x.readings.so2_twenty_four_hourly.north + "</td>";
            temp += "<td>" + x.readings.so2_twenty_four_hourly.south + "</td>";
            temp += ("</tr>");

            temp += ("<tr>");
            temp += "<td>" + keys[9] +"</td>"; 
            temp += "<td>" + x.readings.pm25_sub_index.national + "</td>";
            temp += "<td>" + x.readings.pm25_sub_index.central + "</td>";
            temp += "<td>" + x.readings.pm25_sub_index.west + "</td>";
            temp += "<td>" + x.readings.pm25_sub_index.east + "</td>";
            temp += "<td>" + x.readings.pm25_sub_index.north + "</td>";
            temp += "<td>" + x.readings.pm25_sub_index.south + "</td>";
            temp += ("</tr>")

            temp += ("<tr>");
            temp += "<td>" + keys[10] +"</td>"; 
            temp += "<td>" + x.readings.psi_twenty_four_hourly.national + "</td>"; 
            temp += "<td>" + x.readings.psi_twenty_four_hourly.central + "</td>"; 
            temp += "<td>" + x.readings.psi_twenty_four_hourly.west + "</td>"; 
            temp += "<td>" + x.readings.psi_twenty_four_hourly.east + "</td>";
            temp += "<td>" + x.readings.psi_twenty_four_hourly.north + "</td>";
            temp += "<td>" + x.readings.psi_twenty_four_hourly.south + "</td>"; 
            temp += ("</tr>")

            temp += ("<tr>");
            temp += "<td>" + keys[11] +"</td>"; 
            temp += "<td>" + x.readings.o3_eight_hour_max.national + "</td>"; 
            temp += "<td>" + x.readings.o3_eight_hour_max.central + "</td>"; 
            temp += "<td>" + x.readings.o3_eight_hour_max.west + "</td>"; 
            temp += "<td>" + x.readings.o3_eight_hour_max.east + "</td>"; 
            temp += "<td>" + x.readings.o3_eight_hour_max.north + "</td>"; 
            temp += "<td>" + x.readings.o3_eight_hour_max.south + "</td>"; 
            temp += ("</tr>");
            
          });
          
          document.getElementById('data').innerHTML += temp;

          function toMonthName(monthNumber) {
          const date = new Date();
          date.setMonth(monthNumber - 1);

          return date.toLocaleString([], {
            month: 'short',
          });
        }

          data.items.forEach((input) => {
            console.log(new Date(input.update_timestamp))
            const updatedDate = new Date(input.update_timestamp)
            const updatedYear = updatedDate.getFullYear();
            const updatedMonth = updatedDate.getUTCMonth() + 1;
            const updatedDay = updatedDate.getUTCDate();
            console.log(toMonthName(updatedMonth))

            const hours = updatedDate.getHours();
            let min = updatedDate.getMinutes();
            min = min <= 9 ? '0' + min : min;

            time += "Last updated: " +updatedDay + " " + toMonthName(updatedMonth) + " " + updatedYear + ", " + hours + ":" + min;
          });
          document.getElementById('timestamp').innerHTML = time;
          
      }

      
    )
  }
)
</script>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.3/dist/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
